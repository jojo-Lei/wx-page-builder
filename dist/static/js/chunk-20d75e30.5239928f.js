(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-20d75e30"],{2610:function(e,t,a){"use strict";var i=a("947b"),s=a.n(i);s.a},"3c34":function(e,t,a){"use strict";var i=a("cd72"),s=a.n(i);s.a},"63a6":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"clearfix my-page-list"},[a("div",{staticClass:"page-search-wrapper"},[a("el-tabs",{on:{"tab-click":e.handlePageModeClick},model:{value:e.searchParams.pageMode,callback:function(t){e.$set(e.searchParams,"pageMode",t)},expression:"searchParams.pageMode"}},e._l(e.pageModeList,(function(t,i){return a("el-tab-pane",{key:i,attrs:{name:t.value,disabled:t.disabled}},[a("div",{attrs:{slot:"label"},slot:"label"},[a("span",{staticClass:"nav-tabs-label"},[e._v(e._s(t.label))])])])})),1)],1),a("div",{staticClass:"page-content"},[a("div",{staticClass:"my-page-nav-list"},[a("div",{staticClass:"my-page-nav-item",class:{active:"my"===e.searchParams.type},on:{click:function(t){return e.doSearch("my")}}},[e._v("我的作品("+e._s(e.myCount)+")")])]),a("ul",{staticClass:"page-item-wrapper"},[a("li",{staticClass:"page-item create",on:{click:e.createNewPage}},[a("div",{staticClass:"temp-create"},[a("i",{staticClass:"el-icon-plus"}),a("p",{staticClass:"paddingT10"},[e._v("创建"+e._s(e._f("getLabelText")(e.searchParams.pageMode,e.pageModeList)))])])]),e._l(e.pageList,(function(t,i){return a("li",{key:i,staticClass:"page-item"},[t.isPublish?e._e():a("span",{staticClass:"unpublish"},[e._v("未发布")]),a("div",{staticClass:"header-mask"},[a("div",{staticClass:"details-btn",on:{click:function(a){return e.showPreviewFn(t._id)}}},[e._v("预览")])]),a("div",{staticClass:"cover"},[a("img",{attrs:{src:t.coverImage||e.defaultCoverImage,alt:""}})]),a("div",{staticClass:"page-item-title border-T"},[a("span",{staticClass:"item-title-i"},[e._v(e._s(t.title))])]),a("div",{staticClass:"page-item-data-pv border-T"},[a("div",{staticClass:"btn-wrapper"},[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.editPage(t._id)}}},[e._v("编辑")])],1),a("div",{staticClass:"btn-wrapper"},[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.copyPage(t._id)}}},[e._v("复制")])],1),a("div",{staticClass:"btn-wrapper"},[a("el-dropdown",{attrs:{placement:"top-start"}},[a("span",{staticClass:"el-dropdown-link"},[a("el-button",{attrs:{type:"text",size:"mini"}},[e._v("更多 "),a("i",{staticClass:"el-icon-more-outline"})])],1),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t.isPublish||"my"!==e.searchParams.type?e._e():a("el-dropdown-item",[a("div",{on:{click:function(a){return e.publishPage(t._id,i)}}},[e._v("发布")])]),a("el-dropdown-item",[a("div",{on:{click:function(a){return e.setAsTemplate(t._id)}}},[e._v("复制为模板")])]),a("el-dropdown-item",[a("div",{on:{click:function(a){return e.showPageData(t._id)}}},[e._v("页面数据")])]),"my"===e.searchParams.type?a("el-dropdown-item",[a("div",{on:{click:function(a){return e.showAddUser(t._id)}}},[e._v("添加成员")])]):e._e(),"my"===e.searchParams.type?a("el-dropdown-item",[a("div",{on:{click:function(a){return e.deletePage(t._id,i)}}},[e._v("删除")])]):e._e(),"share"===e.searchParams.type?a("el-dropdown-item",[a("div",{on:{click:function(a){return e.deleteShareUserPage(t._id,i)}}},[e._v("移出我的参与")])]):e._e()],1)],1)],1)])])}))],2)]),a("div",{staticClass:"custom-dialog"},[a("el-dialog",{attrs:{title:"添加成员",visible:e.dialogVisible,width:"500px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{attrs:{"label-width":"120px"}},[a("el-form-item",{attrs:{label:"用户名/姓名:"}},[a("el-select",{staticClass:"full-input-w",attrs:{multiple:"",filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入用户名/姓名搜索","remote-method":e.remoteMethod,loading:e.addUserloading},model:{value:e.addUserForm.userIds,callback:function(t){e.$set(e.addUserForm,"userIds",t)},expression:"addUserForm.userIds"}},e._l(e.userDataList,(function(e){return a("el-option",{key:e._id,attrs:{label:e.username,value:e._id}})})),1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.submitAddUser}},[e._v("确 定")])],1)],1)],1),e.showPreview?a("previewPage",{attrs:{pageId:e.previewId},on:{closePreview:function(t){e.showPreview=!1}}}):e._e()],1)},s=[],n=(a("5ab2"),a("6d57"),a("e10e"),a("b081")),o=a("1336"),r=a("73f6");function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){Object(n["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var d={components:{previewPage:r["a"]},data:function(){return{loading:!1,defaultCoverImage:a("18e4"),pageList:[],myCount:0,shareCount:0,previewId:"",showPreview:!1,dialogVisible:!1,addUserloading:!1,userDataList:[],pageModeList:[{value:"h5",label:"H5",disabled:!1},{value:"pc",label:"PC页面",disabled:!1},{value:"longPage",label:"长页H5",disabled:!0}],addUserForm:{id:"",userIds:[]},searchParams:{type:"my",pageMode:"h5"}}},created:function(){this.getPageList(),this.getPagesCount(),this.previewId=this.$route.query.previewId||"",this.previewId&&(this.showPreview=!0)},methods:{doSearch:function(e){this.searchParams.type=e,this.getPageList()},getPagesCount:function(){var e=this;this.$axios.get("/page/myPages/count",this.searchParams).then((function(t){e.myCount=t.body.my,e.shareCount=t.body.share}))},getPageList:function(){var e=this;this.$axios.get("/page/myPages",this.searchParams).then((function(t){e.pageList=t.body||[]}))},createNewPage:function(){var e=this,t=o["a"].getProjectConfig();this.loading=!0,this.$axios.post("/page/add",c({},t,{pageMode:this.searchParams.pageMode,author:this.$store.state.user.userId})).then((function(t){e.loading=!1,t.body&&e.$router.push({path:"editor",query:{id:t.body._id}})})).catch((function(){e.loading=!1}))},editPage:function(e){this.$router.push({path:"editor",query:{id:e}})},copyPage:function(e){var t=this;this.loading=!0,this.$axios.post("/page/copy/"+e).then((function(e){t.loading=!1,e.body&&t.$router.push({path:"editor",query:{id:e.body._id}})})).catch((function(){t.loading=!1}))},deletePage:function(e,t){var a=this;this.$confirm("此操作将永久删除该页面, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){a.loading=!0,a.$axios.delete("/page/delete/"+e).then((function(){a.loading=!1,a.pageList.splice(t,1),a.getPagesCount()})).catch((function(){a.loading=!1}))}))},showPreviewFn:function(e){this.previewId=e,this.showPreview=!0},showAddUser:function(e){this.addUserForm.id=e,this.dialogVisible=!0},remoteMethod:function(e){var t=this;""!==e?(this.addUserloading=!0,this.$axios.get("/user/list/search",{keywords:e}).then((function(e){t.addUserloading=!1,t.userDataList=e.body||[]})).catch((function(){t.addUserloading=!1}))):this.options=[]},submitAddUser:function(){var e=this;this.loading=!0,this.$axios.post("/page/shareToUser/"+this.addUserForm.id,{userIds:this.addUserForm.userIds}).then((function(){e.loading=!1,e.dialogVisible=!1,e.$message.success("已添加！")})).catch((function(){e.loading=!1}))},deleteShareUserPage:function(e,t){var a=this;this.$confirm("确认从我的参与作品中删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){a.loading=!0,a.$axios.post("/page/deleteShareToUser/"+e).then((function(){a.loading=!1,a.pageList.splice(t,1),a.getPagesCount()})).catch((function(){a.loading=!1}))}))},showPageData:function(e){this.$router.push({name:"pageDataDetail",query:{id:e}})},setAsTemplate:function(e){var t=this;this.loading=!0,this.$axios.post("/page/setTemplate/"+e).then((function(){t.loading=!1,t.$alert("已添加到我的模板库","操作提示",{confirmButtonText:"确定"})})).catch((function(){t.loading=!1}))},publishPage:function(e,t){var a=this;this.loading=!0,this.$axios.post("/page/publish/"+e).then((function(){a.loading=!1,a.$alert("页面发布成功！","操作提示",{confirmButtonText:"确定"}),a.pageList[t].isPublish=!0})).catch((function(){a.loading=!1}))},handlePageModeClick:function(){this.getPageList(),this.getPagesCount()}}},u=d,p=(a("3c34"),a("2610"),a("e90a")),h=Object(p["a"])(u,i,s,!1,null,"2f63e387",null);t["default"]=h.exports},"947b":function(e,t,a){},cd72:function(e,t,a){}}]);